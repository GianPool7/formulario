<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Reclamo</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link href="https://fonts.cdnfonts.com/css/clan-pro" rel="stylesheet">
</head>
<body>
    <style>
        *{
            padding: 0;
            margin: 0;
            box-sizing: border-box;
            font-family: 'Clan Pro', sans-serif;
        }

        /**/

        .badge{
            /* background-color: #ff4c00; */ 
            color: #ff4c00;
            padding: 4px;
            border-radius: 10px;
            text-align: center;
        }

        /**/

        .cajas{
            display: flex;
            justify-content: space-around;
        }

        .caja{
            background-color: white;
            width: 20%;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            border-radius: 20px;
            box-shadow: 1px 5px 10px black;
            cursor: pointer;
            transition: transform 0.5s ease-in-out; /* duraci√≥n + efecto suave */
        }

        .sede{
            background-color: #002ccc;
            padding: 10px;
            margin: 10px;
            border-radius: 10px;
            color: white;
            cursor: pointer;
        }

        .preguntasolas h2{
            color: #ff4c00;
        }

        .caja:hover {
        transform: scale(1.1); 
        }

        .titulo{
            background-color: #002ccc;
            color: white;
            text-align: center;
            padding: 4px;
            border-radius: 8px;
            font-size: 20px;
            width: 50%;
            display: block;
            margin: auto;
        }

        .contenedor{
            padding: 8px;
        }

        .contenedor p{
            font-weight: bold;
        }

        /* preguntas */

        .contenedor-preguntas{
            display: none;
        }

        .caja-preguntas{
            width: 100%;
            padding: 20px;
            margin-top: 40px;
            font-size: 20px;
            display: flex;
            justify-content: center;
            flex-direction: column;
            gap: 10px;
        }

        .contendor-cajas{
            width: 60%;
            display: block;
            margin: auto;
        }

        /**/

        .menor{
            padding: 10px;
            display: flex;
            gap: 20px;
        }

        .menor div{
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 50%;
            padding: 5px;  
        }

        /**/

        .preguntitas{
            padding: 10px;
            display: flex;
            justify-content: space-around;
            gap: 20px;
        }

        .preguntitas div{
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 50%;
            padding: 5px;
        }

        .preguntasolas{
            padding: 10px;
        }

        .preguntasolas div{
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 5px;
        }

        .preguntasolas span{
            color: red;
        }

        .preguntitas span{
            color: red;
        }

        input{
            width: 100%;
            padding: 20px;
            outline: none;
            border: none;
            font-size: 20px;
            border: 1px solid #002ccc;
            border-radius: 10px;
        }

        input[type="text"],
        input[type="email"] {
            width: 100%;
            padding: 20px;
            outline: none;
            border: none;
            font-size: 20px;
            border: 1px solid #002ccc;
            border-radius: 10px;
        }

        select{
            width: 100%;
            padding:20px;
            outline: none;
            border: none;
            font-size: 20px;
            background-color: white;
            border: 1px solid #002ccc;
            border-radius: 10px;
        }


        .opcion-seleccionada{
            font-weight: bold;
        }

        /**/

        .queja-reclamo{
            display: flex;
            flex-direction: column;
            gap: 20px;
            background-color: red;
            justify-content: center;
        }

        /**/

        .radioinputs{
            padding: 10px;
            display: flex;
            width: 50%;
            justify-content: space-around;
        }

        .siOno{
            display: flex;
            padding: 10px;
        }

        .sino{
            display: flex;
            justify-content: center;
            gap: 10px;
            align-items: center;
        }

        .contenedor-notifiacion{
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .notificaciones{
            padding: 20px;
            text-align: center;
            width: 50%;
            border: 2px solid #11F5F7;
            border-radius: 10px;
            display: none;
            color: #002ccc;
        }
        /**/
        .preguntasmenor{
            display: none;
        }

        /**/

        .opciones{
            display: none;
            justify-content: space-around;
            margin-bottom: 20px;
        }

        .opciones div{
            padding: 6px;
            border-radius: 10px;
            cursor: pointer;
        }

        .back{
            display: none;
            justify-content: center;
            padding: 10px;
            margin-bottom: 10px;
            color: #ff4c00;
            font-weight: bold;
            text-decoration: underline;
            cursor: pointer;
        }

        .next{
            padding: 10px;
            margin-bottom: 10px;
            color: #002ccc;
            font-weight: bold;
            text-decoration: underline;
            cursor: pointer;
            text-align: center;
        }

        /**/

        .preguntas-reclamos{
            display: none;
        }

        .preguntas-queja{
            display: none;
        }


        .especificar-queja{
            display: none;
        }

        .btn{
            display: flex;
            justify-content: center;
            padding: 10px;
        }

        .btn-ica{
            background-color: #ff4c00;
        }

        .btn button{
            width: 30%;
            padding: 10px;
            border-radius: 10px;
            outline: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: white;
            background-color: #002ccc;
        }
        /**/

        .contenedor-ticket{
            display: none;
            justify-content: center;
            text-align: center;
            font-size: 20px;
        }

        .contenedor-ticket div{
            border: 2px solid #11F5F7;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .contenedor-ticket h3{
            color: #ff4c00;
        }

        .contenedor-ticket p{
            color: #002ccc;
        }

        .descargar{
            border: none;
            background-color: #ff4c00;
            padding: 5px;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
        }

        .inicio{
            border: none;
            background-color: #002ccc;
            padding: 5px;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
            text-decoration: none;
        }

        /* para quitar las flechas de arriba y abajo */

        /* para el mensajito */

        .message{
            background-color: aliceblue;
            border-radius: 20px; 
            padding: 20px;
        }

        .message-two{
            margin: 20px 0 20px 0;
            text-align: center;
        }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
        }

        input[type="number"] {
        -moz-appearance: textfield;
        }

        /**/

        /*responsivo*/


        @media only screen and (max-width: 768px) {
            .preguntitas{
                flex-wrap: wrap;
            }
            .contendor-cajas{
                width: 100%;
            }
            .preguntitas div{
                width: 100%;
            }
            .cajas{
                flex-wrap: wrap;
                padding: 10px;
            }
            .caja{
                background-color: white;
                width: 80%;
                padding: 10px;
                display: flex;
                flex-direction: column;
                flex-wrap: wrap;
                gap: 6px;
                border-radius: 20px;
                box-shadow: 1px 5px 10px black;
                cursor: pointer;
                transition: transform 0.5s ease-in-out; /* duraci√≥n + efecto suave */
            }
            .opciones{
                flex-wrap: wrap;
                gap: 10px;
            }
        }
    </style>

    <div id="todas-sedes">
        <input type="text" value="2" id="sedes" disabled>
    </div>

    <div>
        <input type="number" disabled id="tipo" style="display: none;">

        <div class="cajas" id="contenedor-indecopi-reclamos">
            <div class="caja" id="indecopi">
                <div class="titulo">
                    <h3>INDECOPI</h3>
                </div>
                <div class="contenedor">
                    <span>
                        Instituto Nacional de Defensa de la
                        Competencia y de la Protecci√≥n de la
                        Propiedad Intelectual, relacionado a quejas o
                        reclamos.
                    </span>
                    <div>
                        <p>Reclamo:</p>
                        <span>
                            Disconformidad respecto a los productos o servicios comercializados por la Empresa Operadora.
                        </span>
                    </div>
                    <div>
                        <p>Queja:</p>
                        <span>
                            Disconformidad, molestia o descontento respecto a la calidad de la atenci√≥n recibida por parte de la Empresa Operadora.
                        </span>
                    </div>
                </div>
            </div>

            <div class="caja" id="reclamos">
                <div class="titulo">
                    <h3>OSIPTEL</h3>
                </div>
                <div class="contenedor">
                    <span>
                        Organismo Supervisor de Inversi√≥n Privada
                        en Telecomunicaciones, relacionado
                        solamente al servicio de internet.
                    </span>
                    <li>Facturaci√≥n y Cobro</li>
                    <li>Calidad e idoneidad en la prestaci√≥n del Servicio</li>
                    <li>Incumplimiento de Condiciones Contractuales</li>
                    <li>Falta de Servicio</li>
                    <li>Instalaci√≥n, activaci√≥n o traslado del servicio</li>
                    <li>Falta de ejecuci√≥n de baja o suspensi√≥n del servicio.</li>
                    <li>Contrataci√≥n no solicitada</li>
                    <li>Migraci√≥n</li>
                    <li>Otras Materias Reclamables</li>
                </div>
            </div>
        </div>

        <div class="contenedor-preguntas" id="preguntas">

            <form action="" id="">

                <div class="caja-preguntas">

                    <div class="contendor-cajas" id="datosconsumidor">

                        <div class="preguntasolas">
                            <h2>Datos del consumidor</h2>
                            <hr>
                        </div>

                        <div class="preguntitas">
                            <div>
                                <label for="tipodocumento">Tipo de documento de identidad <span>*</span> </label>
                                <select name="tipodocumento" id="tipodocumento" required>
                                    <option value="" class="opcion-seleccionada">Selecciona un tipo de documento</option>
                                    <option value="DNI">Documento de Identidad (DNI)</option>
                                    <option value="RUC">Registro √önico de Contribuyentes (RUC)</option>
                                    <option value="Pasaporte">Pasaporte</option>
                                    <option value="CE">Carnet de Extranjer√≠a(CE)</option>
                                </select>
                                <span class="error-campo" id="error-tipodocumento" style="display: none;">Este campo es obligatorio</span>
                            </div>

                            <div>
                                <label for="numerodocumento">N¬∞ del documento de identidad <span>*</span> </label>
                                <input type="text" inputmode="numeric" pattern="[0-9]*" name="numerodocumento" id="numerodocumento" placeholder="Numero de identificacion *" required disabled>
                                <p class="badge" id="longitud" style="display: none;"> ! El numero del documento debe ser valido </p>
                                <span class="error-campo" id="error-numerodocumento" style="display: none;">Este campo es obligatorio</span>
                            </div>
                        </div>

                        <div class="preguntitas">
                            <div>
                                <label for="nombres">Nombres completos <span>*</span> </label>
                                <input type="text" name="nombres" id="nombres" placeholder="Nombres completos *" required>
                                <span class="error-campo" id="error-nombres" style="display:none;">Este campo es obligatorio</span>
                            </div>

                            <div>
                                <label for="apellidos">Apellidos completos <span>*</span> </label>
                                <input type="text" name="apellidos" id="apellidos" placeholder="Apellidos completos *" required>
                                <span class="error-campo" id="error-apellidos" style="display:none;">Este campo es obligatorio</span>
                            </div>
                        </div>

                        <div class="menor">

                            <div>
                                <label for="menorEdad">Menor de edad <span>*</span> </label>
                                <select name="menorEdad" id="menorEdad" required>
                                    <option value="" class="opcion-seleccionada">Seleccionar Opci√≥n</option>
                                    <option value="Si">Si</option>
                                    <option value="No">No</option>
                                </select>
                                <span class="error-campo" id="error-menorEdad" style="display:none;">Este campo es obligatorio</span>
                            </div>

                            <div id="menor" style="display: none;">

                                <label for="padre">Nombre del Pap√° o Mam√° <span>*</span> </label>
                                <input type="text" name="padre" id="padre" placeholder="Nombre del Padre o de la Madre">
                                
                            </div>
                        </div>

                        <div class="preguntitas" id="departamentos-lima">

                            <div>
                                <label for="departamento">Departamento <span>*</span></label>
                                <select name="departamento" id="departamento" required>
                                    <option value="Lima" class="opcion-seleccionada" selected>Lima</option>
                                </select>
                                <span class="error-campo" id="error-departamento" style="display:none;">Este campo es obligatorio</span>
                            </div>

                            <div>
                                <label for="provincias-lima">Provincias<span>*</span> </label>
                                <select name="provincias-lima" id="provincias-lima" required>
                                    <option value="">Seleccionar Opci√≥n</option>
                                    <option value="128">Lima</option>
                                    <option value="134">Huarochiri</option>
                                    <option value="67">Callao</option>
                                </select>
                                <span class="error-campo" id="error-provincias" style="display:none;">Este campo es obligatorio</span>
                            </div>

                        </div>

                        <div class="preguntitas" id="departamentos-ica">

                            <div>
                                <label for="departamento-ica">Departamento <span>*</span></label>
                                <select name="departamento-ica" id="departamento-ica" required>
                                    <option value="Ica" class="opcion-seleccionada" selected>Ica</option>
                                </select>
                                <span class="error-campo" id="error-departamento" style="display:none;">Este campo es obligatorio</span>
                            </div>

                            <div>
                                <label for="provincias-ica">Provincias<span>*</span> </label>
                                <select name="provincias-ica" id="provincias-ica" required>
                                    <option value="Ica" selected>Ica</option>
                                </select>
                                <span class="error-campo" id="error-provincias" style="display:none;">Este campo es obligatorio</span>
                            </div>

                        </div>


                        <div class="preguntitas">

                            <div id="distritos-lima">
                                <label for="distritos">Distritos <span>*</span></label>
                                <select name="distritos" id="distritos">
                                </select>
                                <span class="error-campo" id="error-distritos" style="display:none;">Este campo es obligatorio</span>
                            </div>

                            <div id="distritos-icas">
                                <label for="distritos">Distritos <span>*</span></label>
                                <select name="distritos-ica" id="distritos-ica">
                                    <option value="">Seleccionar opci√≥n</option>
                                    <option value="Ica">Ica</option>
                                    <option value="La Tingui√±a">La Tingui√±a</option>
                                    <option value="Los Aquijes">Los Aquijes</option>
                                    <option value="Ocucaje">Ocucaje</option>
                                    <option value="Pachacutec">Pachacutec</option>
                                    <option value="Parcona">Parcona</option>
                                    <option value="Pueblo Nuevo">Pueblo Nuevo</option>
                                    <option value="Salas">Salas</option>
                                    <option value="Tate">Tate</option>
                                    <option value="San Jose De Los Molinos">San Jose De Los Molinos</option>
                                    <option value="San Juan Bautista">San Juan Bautista</option>
                                    <option value="Santiago">Santiago</option>
                                    <option value="Subtanjalla">Subtanjalla</option>
                                </select>
                                <span class="error-campo" id="error-distritos" style="display:none;">Este campo es obligatorio</span>
                            </div>

                            <div>
                                <label for="correo">Direccion de correo electronico <span>*</span> </label>
                                <input type="email" name="correo" id="correo" placeholder="fiberpro@gmail.com" required>
                                <p class="badge" id="error-correo" style="display:none;">! El correo electr√≥nico debe ser v√°lido</p>
                            </div>

                        </div>


                        <div class="preguntitas">

                            <div>
                                <label for="movil">Contacto de referencia (movil o fijo) <span>*</span> </label>
                                <input type="text" inputmode="numeric" pattern="[0-9]*" placeholder="999 999 999" maxlength="9" name="movil" id="movil" required>
                                <p class="badge" id="longitud-Movil"> solo tiene que contener 9 digitos </p>
                                <span class="error-campo" id="error-movil" style="display:none;">Este campo es obligatorio</span>
                            </div>
                        
                            <div>
                                <label for="direccion">Direcci√≥n <span>*</span> </label>
                                <input type="text" name="direccion" placeholder="Av." id="direccion" required>
                                <span class="error-campo" id="error-direccion" style="display:none;">Este campo es obligatorio</span>
                            </div>

                        </div>


                        
                        <div class="siOno">
                            <p>Autorizo ser notificado por el correo electr√≥nico registrado: </p>
                            <div class="radioinputs">
                                <div class="sino">
                                    <input type="radio" name="notificar" id="si" value="si">
                                    <label for="si">Si</label>
                                </div>
                                <div class="sino">
                                    <input type="radio" name="notificar" id="no" value="no">
                                    <label for="no">No</label>
                                </div>
                            </div>
                        </div>

                        <div>
                            <p id="mensajeError" style="color: red; display: none;">Este campo es obligatorio.</p>
                        </div>

                        <div class="contenedor-notifiacion">
                            <div class="notificaciones" id="msj">
                                <p id="txtrespuesta"></p>
                                <span id="txtcorreo"></span>
                            </div>
                        </div>

                        <div class="next">
                            <p id="reclamos-queja">continuar</p>
                        </div>

                    </div>

                </div>
                
                <div id="contenedor-reclamos-queja">

                    <div class="back" id="contenedor-regresar">
                        <div>
                            <p id="regresar"> < Volver</p>
                        </div>
                    </div>

                    <div class="opciones" id="opciones-reclamo-queja">

                        <div class="caja" id="reclamo">
                            <div class="titulo">
                                <h2>Reclamo</h2>
                            </div>
                            <div class="contenedor">
                                <span>Disconformidad relacionada con los productos o servicios prestados comercializados por la Empresa Operadora.</span>
                            </div>
                        </div>

                        <div class="caja" id="queja">
                            <div class="titulo">
                                <h2>Queja</h2>
                            </div>
                            <div class="contenedor">
                                <span>Disconformidad, molestia o descontento en referencia a la calidad de la atenci√≥n brindada al consumidor, por parte de la Empresa Operadora.</span>
                            </div>
                        </div>

                    </div>


                    <div class="contendor-cajas">

                        <div class="preguntas-reclamos" id="contenedorpreguntasreclamos">

                            <div class="preguntasolas">
                                <div>
                                    <label for="materiareclamo">Materia de Reclamo <span>*</span></label>
                                    <select name="materiareclamo" id="materiareclamo">
                                        <option value="" disabled>Seleccionar reclamo</option>
                                        <option value="1">Problemas con mi router/Modem</option>
                                        <option value="2">Problemas con mi repetidor</option>
                                        <option value="3">otros</option>
                                    </select>
                                </div>

                            </div>


                        </div>

                        <div class="preguntas-queja" id="contenedorpreguntasquejas">

                            <div class="preguntasolas">
                                <div>
                                    <label for="materiaqueja">Materia de Queja <span>*</span></label>
                                    <select name="materiaqueja" id="materiaqueja">
                                        <option value="" disabled>Seleccionar Queja</option>
                                        <option value="4">Problema con la atenci√≥n por canal presencial.</option>
                                        <option value="5">Problema con la atenci√≥n por el canal WhatsApp.</option>
                                        <option value="6">Problema con la atenci√≥n por el canal telef√≥nico.</option>
                                        <option value="7">Problemas con la atenci√≥n al momento de la instalaci√≥n.</option>
                                        <option value="8">Problemas con la atenci√≥n durante la visita t√©cnica.</option>
                                        <option value="9">otros</option>
                                    </select>
                                </div>

                            </div>

                        </div>

                        <div class="" id="preguntas-reclamos-queja">

                            <div class="preguntasolas">

                                <div class="otroreclamos" style="display: none;" id="otrosreclamos">
                                    <label for="">Especificar</label>
                                    <input type="text" id="detalle-reclamo">
                                </div>

                            </div>

                            <div class="preguntitas" id="preguntasreclamos">
                                <div>
                                    <p>Identificaci√≥n del Producto o Servicio adquirido <span>*</span></p>
                                    <input type="text" id="producto" >
                                </div>
                                <div>
                                    <p>Monto del producto o servicio adquirido objeto del reclamo <span>*</span></p>
                                    <input type="number" id="precio">
                                </div>
                            </div>

                            <div class="preguntitas" id="cajaqueja">
                                <div>
                                    <p>Especifique su inconveniente <span>*</span></p>
                                    <input type="text" id="detalle">
                                </div>
                                <div>
                                    <p>Pedido concreto del consumidor: <span>*</span></p>
                                    <input type="text" id="pedido">
                                </div>
                            </div>

                            <div class="preguntasolas">
                                <div>
                                    <label for="">Agregar informaci√≥n adicional (Opcional)</label>
                                    <input type="file" name="" id="pruebasFile">
                                </div>
                            </div>

                        </div>

                        <!-- SECCI√ìN FINAL AGRUPADA -->
                        <div class="message" id="seccion-final-envio">
                            <div id="nota-importante">
                                <strong>NOTA IMPORTANTE:</strong><br><br>
                                PYD TELECOM S.R.L., identificada con RUC N¬∞. 20556147761 y con domicilio en Av. L, Mz. L, Lote 48, Urb. Santo Domingo de Carabayllo ‚Äì 2da Etapa (Av. El Parque con Av. Condorcanqui), distrito de Carabayllo, provincia y departamento de Lima, es titular del Banco de Datos Personales denominado ‚ÄúLibro de Reclamaciones‚Äù, inscrito con el c√≥digo PJ-2025-1901, y en cumplimiento del Art√≠culo 18¬∞ de la Ley N¬∞. 29733, Ley de Protecci√≥n de Datos Personales, le informa que los datos personales que proporcione ser√°n tratados con la finalidad de realizar gestiones vinculadas a la atenci√≥n de reclamos y quejas sobre el producto y atenci√≥n al cliente, brindar el servicio de atenci√≥n al cliente y validar la identidad del cliente.<br><br>
                                Si desea ejercer sus Derechos ARCO (acceso, rectificaci√≥n, cancelaci√≥n, oposici√≥n, informaci√≥n, actualizaci√≥n e inclusi√≥n) puede hacerlo siguiendo el procedimiento indicado en el siguiente enlace: 
                                <a href="https://fiberpro.com.pe/contents/footer/Solicitud%20de%20Derechos%20ARCO.pdf?_t=1751572810" target="_blank" style="color:#007bff;">Solicitud de Derechos ARCO</a>.<br><br>
                                Para conocer m√°s sobre el tratamiento de sus datos personales, puede consultar nuestra Pol√≠tica de Privacidad disponible en el siguiente enlace:
                                <a href="https://fiberpro.com.pe/politicas-privacidad/" target="_blank" style="color:#007bff;">Pol√≠tica de Privacidad</a>.
                            </div>
                        </div>

                        <div class="btn" id="boton-reclamos">
                            <button id="enviarReclamo">Enviar</button>
                        </div>

                        <div class="btn" id="boton-ica">
                            <button id="enviarCorreo">Enviar ica</button>
                        </div>

                        <div class="message-two" id="politica-privacidad">
                            <p>Al hacer clic en ENVIAR aceptas haber le√≠do nuestra
                            <a href="https://fiberpro.com.pe/politicas-privacidad/" target="_blank" style="color:#007bff;">Pol√≠tica de Privacidad</a>.</p>
                        </div>

                    </div>

                </div>
                

            </form>

            <div id="descargarTicketContainer" class="contenedor-ticket">
                <div>
                    <h3>Gracias,</h3>
                    <p>Has llenado correctamente el formulario</p>
                    <p id="codigo"></p>
                    <p>Se envio una copia del formulario a tu correo</p>
                    <a href="https://fiberpro.com.pe/" class="inicio">Inicio</a>
                </div>
            </div>

            <div id="descargarTicketContainerIca" class="contenedor-ticket">
                <div>
                    <h3>Gracias,</h3>
                    <p>Has llenado correctamente el formulario</p>
                    <p>Te estaremos enviado un correo con respuesta reclamo</p>
                    <a href="https://fiberpro.com.pe/sede-ica/" class="inicio">Inicio</a>
                </div>
            </div>


        </div>
    </div>
    
    <!-- Pegas la imagen como <img> oculta en el HTML -->
    <img id="logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..." style="display: none;">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script>


        // boton
        const btncontinuar=document.getElementById('reclamos-queja')
        btncontinuar.style.display="none"
        // para presionar el enter
        document.addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                const tag = event.target.tagName.toLowerCase();
                const type = event.target.type ? event.target.type.toLowerCase() : "";

                // Bloquea ENTER excepto en <textarea>
                if (tag !== 'textarea' && type !== 'submit' && type !== 'button') {
                    event.preventDefault();
                }
            }
        });

        // para validar el correo
        const correo = document.getElementById('correo');
        const errorCorreo = document.getElementById('error-correo');

        // Regex para validar dominios espec√≠ficos
        const correoValidoRegex = /^[a-zA-Z0-9._%+-]+@(gmail\.com|hotmail\.com|outlook\.com|[\w.-]+\.edu.pe)$/i;

        const mensajeFinal=document.getElementById("seccion-final-envio")
        const ppMessage=document.getElementById("politica-privacidad")
        mensajeFinal.style.display="none"
        ppMessage.style.display="none"

        correo.addEventListener('input', () => {
            const esValido = correoValidoRegex.test(correo.value);

            if (!esValido) {
                errorCorreo.style.display = 'inline';
                btncontinuar.style.display="none"
                correo.style.borderColor="red"
            } else {    
                errorCorreo.style.display = 'none';
                btncontinuar.style.display="block"
                correo.style.borderColor="#002ccc"
            }
        });


        // fin de validacion del correo
        // cantidad de numero en el DNI - lo cambia a numerico
        const tipodocumento = document.getElementById('tipodocumento');
        const cajaNroDocumento = document.getElementById('numerodocumento');
        const longitudMaxima = document.getElementById('longitud');

        let longitudEsperada = 0;
        let tipoActual = "";

        // Actualizar estado seg√∫n tipo
        tipodocumento.addEventListener('change', () => {
            cajaNroDocumento.value = "";
            longitudMaxima.style.display = "none"; // Ocultar mensaje

            tipoActual = tipodocumento.value;

            switch (tipoActual) {
                case "DNI":
                    cajaNroDocumento.disabled = false;
                    longitudEsperada = 8;
                    cajaNroDocumento.setAttribute("maxlength", longitudEsperada);
                    break;
                case "RUC":
                    cajaNroDocumento.disabled = false;
                    longitudEsperada = 11;
                    cajaNroDocumento.setAttribute("maxlength", longitudEsperada);
                    break;
                case "CE":
                case "Pasaporte":
                    cajaNroDocumento.disabled = false;
                    longitudEsperada = 12;
                    cajaNroDocumento.setAttribute("maxlength", longitudEsperada);
                    break;
                case "":
                    cajaNroDocumento.disabled = true;
                    cajaNroDocumento.removeAttribute("maxlength");
                    longitudEsperada = 0;
                    break;
                default:
                    cajaNroDocumento.disabled = false;
                    cajaNroDocumento.removeAttribute("maxlength");
                    longitudEsperada = 0;
            }
        });

        // Validar input seg√∫n tipo
        cajaNroDocumento.addEventListener('input', () => {
            if (tipoActual === "DNI" || tipoActual === "RUC") {
                // üîí Solo n√∫meros
                cajaNroDocumento.value = cajaNroDocumento.value.replace(/\D/g, '');
            } else if (tipoActual === "CE" || tipoActual === "Pasaporte") {
                // ‚úÖ Permitir letras y n√∫meros (alfanum√©ricos)
                cajaNroDocumento.value = cajaNroDocumento.value.replace(/[^a-zA-Z0-9]/g, '');
            }

            // Validar longitud
            if (longitudEsperada > 0) {
                if (cajaNroDocumento.value.length !== longitudEsperada) {
                    longitudMaxima.style.display = "flex"; // Mostrar mensaje
                } else {
                    longitudMaxima.style.display = "none"; // Ocultar mensaje
                }
            } else {
                longitudMaxima.style.display = "none";
            }
        });
        // fin de tipo de carnet

        // movil

        const movil = document.getElementById('movil');
        const mensajeMovil = document.getElementById('longitud-Movil');

        const LONGITUD_MOVIL = 9;

        // Ocultamos el mensaje inicialmente
        mensajeMovil.style.display = "none";

        movil.addEventListener('input', () => {
            // Solo n√∫meros
            movil.value = movil.value.replace(/\D/g, '');

            // Validar longitud exacta
            if (movil.value.length !== LONGITUD_MOVIL) {
                mensajeMovil.style.display = "flex";  // Mostrar mensaje
            } else {
                mensajeMovil.style.display = "none";  // Ocultar mensaje
            }
        });

        //
        // el convertidor de archivo a binario
        async function getBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result.split(',')[1]); // s√≥lo el base64, sin el prefijo data:
                reader.onerror = error => reject(error);
            });
        }
        //
        const tipo=document.getElementById('tipo');
        // const cuando escojemos
        const content_indecopi_osiptel=document.getElementById("contenedor-indecopi-reclamos")
        // los select de los departamentos
        const departamentos_lima=document.getElementById("departamentos-lima")
        const departamentos_ica=document.getElementById("departamentos-ica")
        departamentos_lima.style.display="none"
        departamentos_ica.style.display="none"
        // select de los distritos
        const distritos_lima=document.getElementById("distritos-lima")
        const distritos_icas=document.getElementById("distritos-icas")
        distritos_lima.style.display="none"
        distritos_icas.style.display="none"
        //
        const identificar_sede=document.getElementById("sedes").value

        const todas_sedes_ica_lima=document.getElementById("todas-sedes")
        todas_sedes_ica_lima.style.display="none"
        //
        identificar_sede.disabled=true
        //
        const boton_enviar_ica=document.getElementById("boton-ica")
        boton_enviar_ica.style.display="none"
        //
        const indecopi=document.getElementById("indecopi");
        const reclamos = document.getElementById("reclamos");
        const queja=document.getElementById("queja");
        const reclamo=document.getElementById("reclamo");
        const edad=document.getElementById("menorEdad");
        const txt=document.getElementById("txtrespuesta")
        const direccioncorreo=document.getElementById("txtcorreo")
        const direccion=document.getElementById("direccion")
        const materiareclamo=document.getElementById("materiareclamo")
        const materiaqueja=document.getElementById("materiaqueja")
        // const de las preguntas que estan invisible
        const preguntas=document.getElementById("preguntas");
        const preguntasreclamos=document.getElementById("contenedorpreguntasreclamos")
        const preguntasquejas=document.getElementById("contenedorpreguntasquejas")
        const preguntasmenor=document.getElementById("menor")
        const message=document.getElementById("msj")
        const otrosreclamos=document.getElementById("otrosreclamos")
        // para el radio buttom si
        const boton=document.getElementById("boton-reclamos")
        boton.style.display="none"
        // el contenedor de los datos de consumidor
        const datosconsumidor=document.getElementById("datosconsumidor")
        // las opciones
        const reclamoQueja=document.getElementById("opciones-reclamo-queja")
        // para voler
        const btnRegresar=document.getElementById("contenedor-regresar")
        // cajas parecidad
        const cajareclamo=document.getElementById("preguntasreclamos")
        // caja completa de las pregutnas de reclamos
        const cajapreguntasreclamosquejas=document.getElementById("preguntas-reclamos-queja")
        cajapreguntasreclamosquejas.style.display="none"
        // 
        const contenedorreclamoyqueja=document.getElementById("contenedor-reclamos-queja")
        //

        if (identificar_sede=="1") {
            departamentos_lima.style.display="flex"
            distritos_lima.style.display="flex"
        }else if (identificar_sede=="2") {
            departamentos_ica.style.display="flex"
            distritos_icas.style.display="flex"
        }

        btncontinuar.addEventListener('click', function () {

        // üîπ Listas de campos por sede
        const campos_lima = [
            'tipodocumento', 'numerodocumento', 'nombres', 'apellidos', 'menorEdad',
            'departamento', 'provincias-lima', 'distritos', 'correo', 'movil', 'direccion'
        ];

        const campos_ica = [
            'tipodocumento', 'numerodocumento', 'nombres', 'apellidos', 'menorEdad',
            'departamento-ica', 'provincias-ica', 'correo', 'movil', 'direccion'
        ];

        let formularioValido = true;

        /**
         * Valida los campos visibles y marca errores
         */
            const validarCampos = (campos) => {
                campos.forEach(id => {
                const campo = document.getElementById(id);
                const error = document.getElementById('error-' + id);

                // Ignorar campos inexistentes o ocultos
                if (!campo || campo.offsetParent === null) return;

                // Obtener valor seg√∫n tipo de campo
                let valor = '';
                if (campo.tagName === 'SELECT') valor = campo.value;
                else if (campo.type === 'checkbox' || campo.type === 'radio')
                    valor = campo.checked ? 'checked' : '';
                else valor = campo.value ? campo.value.trim() : '';

                // Validar vac√≠o
                if (!valor) {
                    formularioValido = false;
                    campo.classList.add('campo-invalido');
                    if (error) error.style.display = 'block';
                } else {
                    campo.classList.remove('campo-invalido');
                    if (error) error.style.display = 'none';

                }

                // Eliminar error al escribir o cambiar
                const evento = (campo.tagName === 'SELECT') ? 'change' : 'input';
                campo.addEventListener(evento, () => {
                    const nuevoValor = (campo.tagName === 'SELECT') ? campo.value : campo.value.trim();
                    if (nuevoValor) {
                    campo.classList.remove('campo-invalido');
                    if (error) error.style.display = 'none';
                    }
                });
                });
            };

            // üîπ Validar seg√∫n sede activa
            if (identificar_sede == "1") {
                validarCampos(campos_lima);
            } else if (identificar_sede == "2") {
                validarCampos(campos_ica);
            }

            // üîπ Validar radio ‚Äúnotificar‚Äù
            const notificar = document.querySelector('input[name="notificar"]:checked');
            if (!notificar) {
                document.getElementById('mensajeError').style.display = 'block';
                formularioValido = false;
            } else {
                document.getElementById('mensajeError').style.display = 'none';
            }

            // üîπ Resultado final
            if (formularioValido) {
                reclamoQueja.style.display = 'flex';
                contenedorreclamoyqueja.style.display = "block";
                datosconsumidor.style.display = "none";
                btnRegresar.style.display = "flex";
            } else {
                console.warn("‚ùå Formulario con errores");
            }
        
        });


        //
        const radios = document.querySelectorAll('input[name="notificar"]');
        radios.forEach(radio => {
        radio.addEventListener("change", () => {
                if (radio.value === "si" && radio.checked) {
                    message.style.display = "block";
                    txt.textContent=`La respuesta ser√° notificada al siguiente correo electr√≥nico:`
                    direccioncorreo.textContent=`${correo.value}`
                } else if (radio.value === "no" && radio.checked) {
                    message.style.display = "block";
                    txt.textContent=`La respuesta ser√° notificada a la siguiente direcci√≥n:`
                    direccioncorreo.textContent=`${direccion.value}`
                }
            });
        });

        // para otros  en materia reclamable o queja

        if (materiareclamo) {
            materiareclamo.addEventListener("click",()=>{
                if (materiareclamo.value==="3") {
                    otrosreclamos.style.display="block";
                }else{
                    otrosreclamos.style.display="none"
                }
            })
            
        }

        if (materiaqueja) {
            materiaqueja.addEventListener("click",()=>{
                if (materiaqueja.value==="9") {
                    otrosreclamos.style.display="block";
                }else{
                    otrosreclamos.style.display="none"
                }
            })
            
        }

        if(edad){
            edad.addEventListener("click",()=>{
                if (edad.value === "Si") {
                    preguntasmenor.style.display = "flex"; // muestra la caja
                } else {
                    preguntasmenor.style.display = "none"; // oculta la caja
                }
            })
        }

        if (reclamo) {
            reclamo.addEventListener("click",()=>{
                preguntasreclamos.style.display="block";
                preguntasquejas.style.display="none";
                boton.style.display="flex"
                // id_sede(identificar_sede)
                cajareclamo.style.display="flex"
                cajapreguntasreclamosquejas.style.display="block"
                // mostrando el mensajito
                mensajeFinal.style.display="block"
                ppMessage.style.display="block"
                // limpiando cajas
                materiaqueja.value=""
                const productos=document.getElementById('producto').value=""
                const precio=document.getElementById('precio').value=""
                const detalle=document.getElementById('detalle').value=""
                const pedido=document.getElementById('pedido').value=""
                // agregando id al tipo
                tipo.value=1
            })
        }

        if (queja) {
            queja.addEventListener("click",()=>{
                preguntasquejas.style.display="block";
                preguntasreclamos.style.display="none";
                boton.style.display="flex"
                // id_sede(identificar_sede)
                cajareclamo.style.display="none"
                cajapreguntasreclamosquejas.style.display="block"
                // mostrando el mensajito
                mensajeFinal.style.display="block"
                ppMessage.style.display="block"
                // limpiando cajas
                materiareclamo.value=""
                const productos=document.getElementById('producto').value=""
                const precio=document.getElementById('precio').value=""
                const detalle=document.getElementById('detalle').value=""
                const pedido=document.getElementById('pedido').value=""
                // agregando id al tipo
                tipo.value=2
            })
        }

        if (indecopi) {
            indecopi.addEventListener("click",()=>{
                preguntas.style.display = "block";
                content_indecopi_osiptel.style.display="none"
            })
        }
        

        if (reclamos) {
            reclamos.addEventListener("click", () => {
            window.open("https://fiberpro.com.pe/reclamos/", "_blank");
            });
        }

        /**/

        // Cargar distritos desde API cuando sede = 1
        if (identificar_sede == "1") {
        const provinciaSelect = document.getElementById('provincias-lima');
        const distritoSelect = document.getElementById('distritos');

        provinciaSelect.addEventListener('change', function () {
            const provinciaId = this.value;
            distritoSelect.innerHTML = '<option value="">Seleccione un distrito</option>';

            if (!provinciaId) return;

            fetch(`https://app-externos.fiberpro.com.pe/api/get_district/${provinciaId}`)
            .then(response => response.json())
            .then(data => {
                distritoSelect.innerHTML = '';
                data.forEach(distrito => {
                const option = document.createElement('option');
                option.value = distrito.value;
                option.textContent = distrito.label;
                distritoSelect.appendChild(option);
                });
            })
            .catch(err => {
                console.error('‚ùå Error al cargar distritos:', err);
                distritoSelect.innerHTML = '<option value="">Error al cargar</option>';
            });
        });

        // üîπ Llamar autom√°ticamente al cargar
        provinciaSelect.dispatchEvent(new Event('change'));
        }

        // para regresar
        const regresar=document.getElementById("regresar").addEventListener("click",()=>{
            datosconsumidor.style.display="block"
            // reclamoQueja.style.display = 'none';
            btnRegresar.style.display="none"
            cajapreguntasreclamosquejas.style.display="none"
            contenedorreclamoyqueja.style.display="none"
            // limpiando cajas
            materiareclamo.value=""
            materiaqueja.value=""
            const productos=document.getElementById('producto').value=""
            const precio=document.getElementById('precio').value=""
            const detalle=document.getElementById('detalle').value=""
            const pedido=document.getElementById('pedido').value=""
            //
            preguntasreclamos.style.display="none";
            preguntasquejas.style.display="none";
            //
            boton.style.display="none"
            //
            mensajeFinal.style.display="none"
            ppMessage.style.display="none"
        })

        /* para la seleccion */
        let quejaOreclamo = "";
        // Variable global para guardar el valor actual seleccionado
        let materiareclamableica = "";

        // Esperar a que el DOM est√© listo
        document.addEventListener("DOMContentLoaded", () => {
            // para brindar el reclamo
            if (reclamo && queja) {
                reclamo.addEventListener("click", () => {
                quejaOreclamo = "1";
                });
                queja.addEventListener("click", () => {
                quejaOreclamo = "2";
                });
            }

            // Escuchar cambios en el select de reclamo
            if (materiareclamo) {
                materiareclamo.addEventListener("change", (e) => {
                materiareclamableica = e.target.value;
                });
            }
            // Escuchar cambios en el select de queja
            if (materiaqueja) {
                materiaqueja.addEventListener("change", (e) => {
                materiareclamableica = e.target.value;
                });
            }
            console.log(materiareclamableica);
        });


        // fin de la funcion global de los id

        // para enviar ala api
       document.getElementById('enviarReclamo').addEventListener('click', async function (event) {
        event.preventDefault();

        const boton = document.getElementById('enviarReclamo');
        const textoOriginal = boton.textContent;
        boton.textContent = 'Enviando...';
        boton.disabled = true;
        btnRegresar.style.display = "none";

        // --- ARCHIVO ---
        const fileInput = document.getElementById('pruebasFile');
        let pruebasBase64 = null;
        if (fileInput.files.length > 0) {
            pruebasBase64 = await getBase64(fileInput.files[0]);
        }

        // --- DATOS COMUNES ---
        const sedesicalima = document.getElementById('sedes').value.trim();
        const tipo = document.getElementById('tipo').value;

        const dataBase = {
            sedesicalima,
            tipo,
            tipodocumento: document.getElementById('tipodocumento').value.trim(),
            numerodocumento: document.getElementById('numerodocumento').value.trim(),
            nombrescompletos: document.getElementById('nombres').value.trim(),
            apellidoscompletos: document.getElementById('apellidos').value.trim(),
            menorEdad: document.getElementById('menorEdad').value.trim(),
            correoelectronico: document.getElementById('correo').value.trim(),
            movil: document.getElementById('movil').value.trim(),
            direccioncasa: document.getElementById('direccion').value.trim(),
            nombrePadre: document.getElementById('padre').value.trim(),
            autorizacion: document.querySelector('input[name="notificar"]:checked')?.value === "si" ? "si" : "",
            materiareclamable: document.getElementById('materiareclamo').value.trim() || document.getElementById('materiaqueja').value.trim(),
            otrosreclamable: document.getElementById('detalle-reclamo').value.trim(),
            productos: document.getElementById('producto').value.trim(),
            precio: document.getElementById('precio').value.trim(),
            detalle: document.getElementById('detalle').value.trim(),
            pedido: document.getElementById('pedido').value.trim(),
        };

        if (pruebasBase64) dataBase.pruebas = pruebasBase64;

        // --- SEG√öN SEDE ---
        let url = "";
        let payload = {};

        if (sedesicalima === "1") {
            url = "https://libro-reclamaciones-fiberpro-e2b1f36f0380.herokuapp.com/api/libroreclamaciones/v2";
            payload = {
                ...dataBase,
                departamento: document.getElementById('departamento').value.trim(),
                provincias: document.getElementById('provincias-lima').value.trim(),
                distrito: document.getElementById('distritos').value.trim(),
            };
        } else if (sedesicalima === "2") {
            url = "https://libro-reclamaciones-fiberpro-e2b1f36f0380.herokuapp.com/api/enviar_pdf";   
            payload = {
                ...dataBase,
                departamento: document.getElementById('departamento-ica').value.trim(),
                provincias: document.getElementById('provincias-ica').value.trim(),
                distrito: document.getElementById('distritos-ica').value.trim(),
            };
        } else {
            alert("Debe seleccionar una sede v√°lida.");
            boton.textContent = textoOriginal;
            boton.disabled = false;
            return;
        }

        // --- ENV√çO ---
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            const result = await response.json();

            if (sedesicalima === "1") {
                // ‚úÖ LIMA - genera ticket
                if (result.ticket_id) {
                    boton.style.display = 'none';
                    document.getElementById('descargarTicketContainer').style.display = 'flex';
                    document.getElementById('codigo').innerText = `Tu c√≥digo de reclamo es: ${result.ticket_id}`;
                    contenedorreclamoyqueja.style.display = "none";
                    window.ticketInfo = { ...payload, ticket_id: result.ticket_id };
                } else {
                    document.getElementById('codigo').innerText = 'Error al registrar el reclamo.';
                    console.error('Error:', result);
                }
            } else if (sedesicalima === "2") {
                // ‚úÖ ICA - solo confirma env√≠o
                if (result.success) {
                    contenedorreclamoyqueja.style.display = "none";
                    boton.style.display = 'none';
                    document.getElementById('descargarTicketContainerIca').style.display = 'flex';
                } else {
                    alert("Error al enviar el reclamo a la sede Ica.");
                    console.error('Error:', result);
                }
            }

        } catch (error) {
            console.error('Error:', error);
            alert('Error de red o del servidor');
        } finally {
            if (boton.style.display !== 'none') {
                boton.textContent = textoOriginal;
                boton.disabled = false;
            }
        }
    });


    </script>
    
</body>
</html>